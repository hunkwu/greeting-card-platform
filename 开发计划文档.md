# ç”µå­è´ºå¡å‡ºæµ·é¡¹ç›® - å¼€å‘è®¡åˆ’æ–‡æ¡£

> åŸºäºAIæŠ€æœ¯çš„å¤šè¯­è¨€ç”µå­è´ºå¡åˆ¶ä½œå¹³å° - æŠ€æœ¯å®æ–½æ–¹æ¡ˆ  
> æœ€åæ›´æ–°ï¼š2026-01-29

---

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### å¼€å‘ç›®æ ‡
æ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æŠ€æœ¯å…ˆè¿›ã€ç”¨æˆ·ä½“éªŒä¼˜ç§€çš„ç”µå­è´ºå¡SaaSå¹³å°ï¼Œæ”¯æŒå…¨çƒåŒ–éƒ¨ç½²å’Œå¤šè¯­è¨€æœåŠ¡ã€‚

### é¡¹ç›®èŒƒå›´
- **MVPé˜¶æ®µ**ï¼šæ ¸å¿ƒåŠŸèƒ½å®ç°ï¼ˆç¼–è¾‘å™¨ã€æ¨¡æ¿ã€ç”¨æˆ·ç³»ç»Ÿã€æ”¯ä»˜ï¼‰
- **ç¬¬ä¸€æœŸ**ï¼šAIåŠŸèƒ½é›†æˆã€ç¤¾äº¤åˆ†äº«ã€åä½œåŠŸèƒ½
- **ç¬¬äºŒæœŸ**ï¼šé«˜çº§åŠŸèƒ½ã€æ€§èƒ½ä¼˜åŒ–ã€å…¨çƒåŒ–éƒ¨ç½²

### å…³é”®é‡Œç¨‹ç¢‘
| é˜¶æ®µ | æ—¶é—´ä¼°ç®— | äº¤ä»˜å†…å®¹ |
|------|----------|----------|
| æŠ€æœ¯è°ƒç ”ä¸æ¶æ„è®¾è®¡ | 2å‘¨ | æŠ€æœ¯é€‰å‹æ–‡æ¡£ã€æ¶æ„è®¾è®¡æ–¹æ¡ˆ |
| MVPå¼€å‘ | 8å‘¨ | åŸºç¡€ç¼–è¾‘å™¨ã€æ¨¡æ¿åº“ã€ç”¨æˆ·ç³»ç»Ÿ |
| AIåŠŸèƒ½é›†æˆ | 3å‘¨ | AIæ–‡æ¡ˆç”Ÿæˆã€è®¾è®¡å»ºè®®åŠŸèƒ½ |
| æ”¯ä»˜ä¸ä¼šå‘˜ç³»ç»Ÿ | 2å‘¨ | è®¢é˜…ä»˜è´¹ã€å¤šæ”¯ä»˜æ–¹å¼é›†æˆ |
| æµ‹è¯•ä¸ä¼˜åŒ– | 2å‘¨ | åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½ä¼˜åŒ–ã€bugä¿®å¤ |
| Betaå‘å¸ƒ | 1å‘¨ | å°è§„æ¨¡ç”¨æˆ·æµ‹è¯• |
| æ­£å¼ä¸Šçº¿ | - | å…¨çƒåŒ–éƒ¨ç½²ã€å¸‚åœºæ¨å¹¿ |

**æ€»è®¡**ï¼šçº¦18å‘¨ï¼ˆ4.5ä¸ªæœˆï¼‰å®ŒæˆMVPåˆ°Betaç‰ˆæœ¬

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "å®¢æˆ·ç«¯å±‚"
        A[Webåº”ç”¨ - React/Next.js]
        B[ç§»åŠ¨ç«¯ - å“åº”å¼]
    end
    
    subgraph "APIç½‘å…³å±‚"
        C[Nginx/API Gateway]
        D[è´Ÿè½½å‡è¡¡]
    end
    
    subgraph "åº”ç”¨æœåŠ¡å±‚"
        E[ç”¨æˆ·æœåŠ¡]
        F[ç¼–è¾‘å™¨æœåŠ¡]
        G[æ¨¡æ¿æœåŠ¡]
        H[AIæœåŠ¡]
        I[æ”¯ä»˜æœåŠ¡]
        J[åˆ†äº«æœåŠ¡]
    end
    
    subgraph "æ•°æ®å±‚"
        K[(PostgreSQL)]
        L[(Redisç¼“å­˜)]
        M[å¯¹è±¡å­˜å‚¨ S3/OSS]
    end
    
    subgraph "ç¬¬ä¸‰æ–¹æœåŠ¡"
        N[OpenAI API]
        O[Stripe/PayPal]
        P[ç¿»è¯‘API]
    end
    
    A --> C
    B --> C
    C --> D
    D --> E
    D --> F
    D --> G
    D --> H
    D --> I
    D --> J
    
    E --> K
    E --> L
    F --> K
    F --> M
    G --> K
    G --> M
    H --> N
    I --> O
    J --> M
```

### æŠ€æœ¯æ ˆé€‰å‹

#### å‰ç«¯æŠ€æœ¯æ ˆ
```diff
+ æ ¸å¿ƒæ¡†æ¶ï¼šNext.js 14+ (React 18+)
  - ä¼˜åŠ¿ï¼šSSRæ”¯æŒã€ä¼˜ç§€çš„SEOã€APIè·¯ç”±ã€å›½é™…åŒ–
  - æ›¿ä»£æ–¹æ¡ˆï¼šNuxt.js (Vueç”Ÿæ€)

+ çŠ¶æ€ç®¡ç†ï¼šZustand / Redux Toolkit
  - è½»é‡çµæ´»ï¼Œé€‚åˆä¸­å¤§å‹åº”ç”¨

+ UIç»„ä»¶åº“ï¼šTailwind CSS + Headless UI
  - é«˜åº¦å®šåˆ¶åŒ–ï¼Œç¬¦åˆç°ä»£è®¾è®¡éœ€æ±‚
  - å¤‡é€‰ï¼šChakra UIã€Ant Design

+ å›¾å½¢ç¼–è¾‘ï¼šFabric.js / Konva.js
  - Canvasæ“ä½œåº“ï¼Œæ”¯æŒæ‹–æ‹½ã€ç¼©æ”¾ã€æ—‹è½¬
  - ç”¨äºå®ç°è´ºå¡ç¼–è¾‘å™¨æ ¸å¿ƒåŠŸèƒ½

+ åŠ¨ç”»åº“ï¼šFramer Motion
  - æµç•…çš„äº¤äº’åŠ¨ç”»å’Œé¡µé¢è¿‡æ¸¡

+ è¡¨å•ç®¡ç†ï¼šReact Hook Form + Zod
  - é«˜æ€§èƒ½è¡¨å•éªŒè¯

+ HTTPå®¢æˆ·ç«¯ï¼šAxios / TanStack Query
  - æ•°æ®è·å–ã€ç¼“å­˜ã€åŒæ­¥
```

#### åç«¯æŠ€æœ¯æ ˆ
```diff
+ æœåŠ¡ç«¯æ¡†æ¶ï¼šNode.js + Express / Nest.js
  - ä¼˜åŠ¿ï¼šJavaScriptå…¨æ ˆã€ç”Ÿæ€ä¸°å¯Œ
  - æ›¿ä»£æ–¹æ¡ˆï¼šPython + FastAPI

+ æ•°æ®åº“ï¼šPostgreSQL 15+
  - ç”¨æˆ·æ•°æ®ã€è´ºå¡å…ƒæ•°æ®ã€è®¢å•ä¿¡æ¯
  - æ”¯æŒJSONå­—æ®µå­˜å‚¨è´ºå¡è®¾è®¡æ•°æ®

+ ç¼“å­˜ï¼šRedis 7+
  - ä¼šè¯ç®¡ç†ã€çƒ­é—¨æ¨¡æ¿ç¼“å­˜ã€APIé™æµ

+ å¯¹è±¡å­˜å‚¨ï¼šAWS S3 / é˜¿é‡Œäº‘OSS
  - å›¾ç‰‡ã€æ¨¡æ¿æ–‡ä»¶ã€ç”¨æˆ·ä¸Šä¼ èµ„æº

+ æ¶ˆæ¯é˜Ÿåˆ—ï¼šRedis Queue / RabbitMQ
  - å¼‚æ­¥ä»»åŠ¡ï¼ˆAIç”Ÿæˆã€é‚®ä»¶å‘é€ã€åˆ†äº«é€šçŸ¥ï¼‰

+ è®¤è¯ï¼šNextAuth.js / JWT
  - OAuthç¤¾äº¤ç™»å½•ã€é‚®ç®±ç™»å½•

+ APIæ–‡æ¡£ï¼šOpenAPI / Swagger
  - è‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£
```

#### AIé›†æˆ
```diff
+ æ–‡æ¡ˆç”Ÿæˆï¼šOpenAI GPT-4 / Kimi
  - å¤šè¯­è¨€ç¥ç¦æ–‡æ¡ˆç”Ÿæˆ
  - è®¾è®¡å»ºè®®å’Œæ’ç‰ˆæ¨è

+ å›¾åƒå¤„ç†ï¼šSharp / ImageMagick
  - å›¾ç‰‡å‹ç¼©ã€æ ¼å¼è½¬æ¢ã€æ°´å°æ·»åŠ 

+ ç¿»è¯‘æœåŠ¡ï¼šGoogle Translate API / DeepL
  - è·¨è¯­è¨€è´ºå¡ç¿»è¯‘
```

#### DevOpsä¸éƒ¨ç½²
```diff
+ å®¹å™¨åŒ–ï¼šDocker + Docker Compose
+ ç¼–æ’ï¼šKubernetes (ç”Ÿäº§ç¯å¢ƒ)
+ CI/CDï¼šGitHub Actions / GitLab CI
+ ç›‘æ§ï¼šPrometheus + Grafana
+ æ—¥å¿—ï¼šELK Stack (Elasticsearch, Logstash, Kibana)
+ CDNï¼šCloudflare / AWS CloudFront
+ åŸŸåDNSï¼šCloudflare DNS
```

---

## ğŸ¯ åŠŸèƒ½æ¨¡å—å¼€å‘è®¡åˆ’

### 1. ç”¨æˆ·ç³»ç»Ÿæ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] ç”¨æˆ·æ³¨å†Œä¸ç™»å½•ï¼ˆé‚®ç®±ã€ç¤¾äº¤ç™»å½•ï¼‰
- [ ] ç”¨æˆ·ä¸ªäººä¸­å¿ƒï¼ˆå¤´åƒã€æ˜µç§°ã€è¯­è¨€åå¥½ï¼‰
- [ ] JWTè®¤è¯ä¸æƒé™ç®¡ç†
- [ ] å¯†ç æ‰¾å›ä¸é‡ç½®
- [ ] å¤šè¯­è¨€ç•Œé¢åˆ‡æ¢

#### æŠ€æœ¯å®ç°
- **è®¤è¯**ï¼šNextAuth.js + JWT
- **ç¤¾äº¤ç™»å½•**ï¼šGoogleã€Facebook OAuth
- **æ•°æ®æ¨¡å‹**ï¼š
  ```sql
  CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),
    display_name VARCHAR(100),
    avatar_url TEXT,
    language VARCHAR(10) DEFAULT 'en',
    subscription_tier VARCHAR(20) DEFAULT 'free',
    subscription_expires_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
  );
  ```

#### æ—¶é—´ä¼°ç®—ï¼š1.5å‘¨

---

### 2. æ¨¡æ¿åº“æ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] æ¨¡æ¿åˆ†ç±»æµè§ˆï¼ˆç”Ÿæ—¥ã€èŠ‚æ—¥ã€æ„Ÿè°¢ç­‰ï¼‰
- [ ] æ¨¡æ¿æœç´¢ä¸ç­›é€‰
- [ ] æ¨¡æ¿é¢„è§ˆä¸æ”¶è—
- [ ] ä¼šå‘˜ä¸“å±æ¨¡æ¿
- [ ] ç®¡ç†åå°ï¼šå…³é”®æ•°æ®æ€»è§ˆã€æ¨¡æ¿ä¸Šä¼ ä¸ç®¡ç†ã€é¡µé¢CMSç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€ç”¨æˆ·å†…å®¹å®¡æ ¸ã€è®¢å•ç®¡ç†ã€å¥—é¤ç®¡ç†ã€æ”¯ä»˜ç®¡ç†ã€AIæ¨¡å‹ç®¡ç†ã€SEOç®¡ç†

#### æŠ€æœ¯å®ç°
- **å­˜å‚¨**ï¼šæ¨¡æ¿JSONæ•°æ®å­˜PostgreSQLï¼Œé¢„è§ˆå›¾å­˜S3
- **æœç´¢**ï¼šPostgreSQLå…¨æ–‡æœç´¢ æˆ– Elasticsearch
- **æ•°æ®æ¨¡å‹**ï¼š
  ```sql
  CREATE TABLE templates (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    category VARCHAR(50),
    tags TEXT[], -- æ ‡ç­¾æ•°ç»„
    preview_image_url TEXT,
    design_data JSONB, -- è´ºå¡è®¾è®¡JSON
    is_premium BOOLEAN DEFAULT false,
    language VARCHAR(10) DEFAULT 'en',
    downloads_count INT DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW()
  );
  ```

#### æ—¶é—´ä¼°ç®—ï¼š2å‘¨

---

### 3. åœ¨çº¿ç¼–è¾‘å™¨æ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] Canvasç”»å¸ƒæ¸²æŸ“
- [ ] æ–‡å­—æ·»åŠ ä¸ç¼–è¾‘ï¼ˆå­—ä½“ã€å¤§å°ã€é¢œè‰²ï¼‰
- [ ] å›¾ç‰‡ä¸Šä¼ ä¸è°ƒæ•´
- [ ] èƒŒæ™¯è®¾ç½®ï¼ˆçº¯è‰²ã€æ¸å˜ã€å›¾ç‰‡ï¼‰
- [ ] å…ƒç´ æ‹–æ‹½ã€ç¼©æ”¾ã€æ—‹è½¬
- [ ] å›¾å±‚ç®¡ç†ï¼ˆä¸Šç§»ã€ä¸‹ç§»ã€ç½®é¡¶ï¼‰
- [ ] æ’¤é”€/é‡åšåŠŸèƒ½
- [ ] è‡ªåŠ¨ä¿å­˜ä¸ç‰ˆæœ¬å†å²
- [ ] å®æ—¶é¢„è§ˆ

#### æŠ€æœ¯å®ç°
- **Canvasåº“**ï¼šFabric.js
  - æä¾›ä¸°å¯Œçš„å›¾å½¢æ“ä½œAPI
  - æ”¯æŒJSONåºåˆ—åŒ–è´ºå¡è®¾è®¡
- **è‡ªåŠ¨ä¿å­˜**ï¼šé˜²æŠ–å‡½æ•° + APIè¯·æ±‚
- **ç‰ˆæœ¬å†å²**ï¼šå­˜å‚¨è®¾è®¡å¿«ç…§åˆ°æ•°æ®åº“
- **æ•°æ®æ¨¡å‹**ï¼š
  ```sql
  CREATE TABLE cards (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    title VARCHAR(255),
    design_data JSONB, -- Fabric.js JSON
    thumbnail_url TEXT,
    share_url VARCHAR(255) UNIQUE,
    share_count INT DEFAULT 0,
    is_public BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
  );
  ```

#### æ—¶é—´ä¼°ç®—ï¼š3å‘¨

---

### 4. AIæ™ºèƒ½åŠ©æ‰‹æ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] AIæ–‡æ¡ˆç”Ÿæˆï¼ˆæ ¹æ®åœºæ™¯å’Œæƒ…æ„Ÿï¼‰
- [ ] è®¾è®¡å»ºè®®ï¼ˆæ’ç‰ˆã€é…è‰²ï¼‰
- [ ] é£æ ¼æ¨è
- [ ] å¤šè¯­è¨€æ–‡æ¡ˆç¿»è¯‘

#### æŠ€æœ¯å®ç°
- **AI Provider**ï¼šOpenAI GPT-4 API
- **Promptå·¥ç¨‹**ï¼š
  ```javascript
  const generateGreetingText = async (occasion, emotion, language) => {
    const prompt = `
      Generate a heartfelt ${occasion} greeting card message in ${language}.
      Emotional tone: ${emotion}.
      Keep it concise (2-3 sentences) and warm.
    `;
    
    const response = await openai.chat.completions.create({
      model: "gpt-4",
      messages: [{ role: "user", content: prompt }],
      max_tokens: 150,
      temperature: 0.8,
    });
    
    return response.choices[0].message.content;
  };
  ```
- **è´¹ç”¨æ§åˆ¶**ï¼š
  - å…è´¹ç”¨æˆ·ï¼šæ¯æœˆé™åˆ¶3æ¬¡AIç”Ÿæˆ
  - ä»˜è´¹ç”¨æˆ·ï¼šæ— é™åˆ¶ä½¿ç”¨
  - ä½¿ç”¨Redisè®°å½•ç”¨æˆ·AIè°ƒç”¨æ¬¡æ•°

#### æ—¶é—´ä¼°ç®—ï¼š2å‘¨

---

### 5. å®æ—¶åä½œæ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] é‚€è¯·åä½œè€…ï¼ˆé€šè¿‡é“¾æ¥æˆ–é‚®ç®±ï¼‰
- [ ] å®æ—¶ç¼–è¾‘åŒæ­¥
- [ ] ç”¨æˆ·æŒ‡é’ˆæ˜¾ç¤º
- [ ] è¯„è®ºä¸åé¦ˆ
- [ ] æƒé™ç®¡ç†ï¼ˆæŸ¥çœ‹/ç¼–è¾‘ï¼‰

#### æŠ€æœ¯å®ç°
- **WebSocket**ï¼šSocket.io
- **æ•°æ®åŒæ­¥**ï¼šOT (Operational Transformation) æˆ– CRDT
- **æ¶æ„**ï¼š
  ```mermaid
  graph LR
      A[ç”¨æˆ·A] -->|WebSocket| C[åä½œæœåŠ¡å™¨]
      B[ç”¨æˆ·B] -->|WebSocket| C
      C -->|å¹¿æ’­å˜æ›´| A
      C -->|å¹¿æ’­å˜æ›´| B
      C -->|æŒä¹…åŒ–| D[(æ•°æ®åº“)]
  ```

#### æ—¶é—´ä¼°ç®—ï¼š2.5å‘¨

---

### 6. ç¤¾äº¤åˆ†äº«æ¨¡å—

#### åŠŸèƒ½ç‚¹
- [ ] ç”Ÿæˆå”¯ä¸€åˆ†äº«é“¾æ¥
- [ ] ç¤¾äº¤åª’ä½“ä¸€é”®åˆ†äº«ï¼ˆFBã€Twitterã€Instagramã€WhatsAppã€å°çº¢ä¹¦ã€å¾®ä¿¡ï¼‰
- [ ] åµŒå…¥ä»£ç ç”Ÿæˆ
- [ ] ä¸‹è½½è´ºå¡ï¼ˆPNGã€JPGã€PDFï¼‰
- [ ] åˆ†äº«ç»Ÿè®¡ï¼ˆæµè§ˆé‡ã€åˆ†äº«æ¬¡æ•°ï¼‰

#### æŠ€æœ¯å®ç°
- **çŸ­é“¾ç”Ÿæˆ**ï¼šnanoidåº“ç”Ÿæˆå”¯ä¸€ID
- **å›¾ç‰‡æ¸²æŸ“**ï¼š
  - å‰ç«¯ï¼šhtml2canvas æˆ– Fabric.toDataURL()
  - åç«¯ï¼šPuppeteeræˆªå›¾æœåŠ¡ï¼ˆç”Ÿæˆé«˜æ¸…é¢„è§ˆå›¾ï¼‰
- **PDFç”Ÿæˆ**ï¼šjsPDF
- **åˆ†äº«æŒ‰é’®**ï¼šreact-shareåº“

#### æ—¶é—´ä¼°ç®—ï¼š1.5å‘¨

---

### 7. æ”¯ä»˜ä¸ä¼šå‘˜ç³»ç»Ÿ

#### åŠŸèƒ½ç‚¹
- [ ] è®¢é˜…è®¡åˆ’å±•ç¤º
- [ ] PayPalæ”¯ä»˜é›†æˆ
- [ ] æ”¯ä»˜å®å›½é™…æ”¯ä»˜
- [ ] Stripeæ”¯ä»˜é›†æˆ
- [ ] å¾®ä¿¡æ”¯ä»˜ï¼ˆå›½å†…å¸‚åœºï¼‰
- [ ] è®¢é˜…ç®¡ç†ï¼ˆå‡çº§ã€é™çº§ã€å–æ¶ˆï¼‰
- [ ] å‘ç¥¨ç”Ÿæˆ
- [ ] Webhookå¤„ç†ï¼ˆæ”¯ä»˜æˆåŠŸ/å¤±è´¥ï¼‰

#### æŠ€æœ¯å®ç°
- **æ”¯ä»˜ç½‘å…³**ï¼šStripe Checkout + Webhooks
- **è®¢é˜…é€»è¾‘**ï¼š
  ```javascript
  // Stripeè®¢é˜…åˆ›å»º
  const subscription = await stripe.subscriptions.create({
    customer: customerId,
    items: [{ price: priceId }], // monthly/quarterly/yearly
    payment_behavior: 'default_incomplete',
    expand: ['latest_invoice.payment_intent'],
  });
  ```
- **Webhookå®‰å…¨**ï¼šéªŒè¯Stripeç­¾å
- **æ•°æ®æ¨¡å‹**ï¼š
  ```sql
  CREATE TABLE subscriptions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(id),
    stripe_subscription_id VARCHAR(255) UNIQUE,
    plan VARCHAR(20), -- 'monthly', 'quarterly', 'yearly'
    status VARCHAR(20), -- 'active', 'cancelled', 'past_due'
    current_period_start TIMESTAMP,
    current_period_end TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW()
  );
  ```

#### æ—¶é—´ä¼°ç®—ï¼š2å‘¨

---

### 8. å¤šè¯­è¨€å›½é™…åŒ–

#### åŠŸèƒ½ç‚¹
- [ ] ç•Œé¢å¤šè¯­è¨€åˆ‡æ¢ï¼ˆi18nï¼‰
- [ ] æ¨¡æ¿å†…å®¹æœ¬åœ°åŒ–
- [ ] è‡ªåŠ¨æ£€æµ‹ç”¨æˆ·è¯­è¨€
- [ ] èŠ‚æ—¥åº“æœ¬åœ°åŒ–ï¼ˆå„å›½èŠ‚æ—¥ï¼‰

#### æŠ€æœ¯å®ç°
- **i18nåº“**ï¼šnext-i18next
- **è¯­è¨€æ–‡ä»¶ç»“æ„**ï¼š
  ```
  /locales
    /en
      common.json
      editor.json
      pricing.json
    /zh
      common.json
      editor.json
      pricing.json
    /fr, /de, /es ...
  ```
- **åŠ¨æ€åŠ è½½**ï¼šæŒ‰éœ€åŠ è½½è¯­è¨€åŒ…ï¼Œå‡å°‘åˆå§‹åŠ è½½ä½“ç§¯

#### æ—¶é—´ä¼°ç®—ï¼š1.5å‘¨

---

### 9. ç®¡ç†åå°

#### åŠŸèƒ½ç‚¹
- [ ] ç”¨æˆ·ç®¡ç†ï¼ˆæŸ¥çœ‹ã€å°ç¦ï¼‰
- [ ] æ¨¡æ¿ç®¡ç†ï¼ˆä¸Šä¼ ã€ç¼–è¾‘ã€åˆ é™¤ï¼‰
- [ ] è®¢å•ç®¡ç†
- [ ] æ•°æ®ç»Ÿè®¡ï¼ˆç”¨æˆ·å¢é•¿ã€æ”¶å…¥ã€æ´»è·ƒåº¦ï¼‰
- [ ] å†…å®¹å®¡æ ¸
- [ ] SEOç®¡ç†
- [ ] AIæ¨¡å‹ç®¡ç†

#### æŠ€æœ¯å®ç°
- **åå°æ¡†æ¶**ï¼šReact Admin / Retool
- **æƒé™æ§åˆ¶**ï¼šRBACï¼ˆåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼‰
- **æ•°æ®å¯è§†åŒ–**ï¼šRecharts / Chart.js

#### æ—¶é—´ä¼°ç®—ï¼š2å‘¨

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„æ€»è§ˆ

```mermaid
erDiagram
    USERS ||--o{ CARDS : creates
    USERS ||--o{ SUBSCRIPTIONS : has
    USERS ||--o{ FAVORITES : saves
    TEMPLATES ||--o{ CARDS : based_on
    TEMPLATES ||--o{ FAVORITES : favorited
    CARDS ||--o{ COLLABORATORS : shared_with
    CARDS ||--o{ COMMENTS : has
    CARDS ||--o{ SHARE_STATS : tracked_by
    
    USERS {
        uuid id PK
        string email
        string password_hash
        string display_name
        string avatar_url
        string language
        string subscription_tier
        timestamp subscription_expires_at
    }
    
    TEMPLATES {
        uuid id PK
        string name
        string category
        array tags
        string preview_image_url
        jsonb design_data
        boolean is_premium
        string language
    }
    
    CARDS {
        uuid id PK
        uuid user_id FK
        string title
        jsonb design_data
        string thumbnail_url
        string share_url
        boolean is_public
        int share_count
    }
    
    SUBSCRIPTIONS {
        uuid id PK
        uuid user_id FK
        string stripe_subscription_id
        string plan
        string status
    }
```

### ç´¢å¼•ç­–ç•¥
```sql
-- ç”¨æˆ·è¡¨
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_subscription_tier ON users(subscription_tier);

-- æ¨¡æ¿è¡¨
CREATE INDEX idx_templates_category ON templates(category);
CREATE INDEX idx_templates_language ON templates(language);
CREATE INDEX idx_templates_tags ON templates USING GIN(tags);

-- è´ºå¡è¡¨
CREATE INDEX idx_cards_user_id ON cards(user_id);
CREATE INDEX idx_cards_share_url ON cards(share_url);
CREATE INDEX idx_cards_created_at ON cards(created_at DESC);
```

---

## ğŸ” å®‰å…¨ä¸åˆè§„

### å®‰å…¨æªæ–½
- [ ] **HTTPSå¼ºåˆ¶**ï¼šæ‰€æœ‰é€šä¿¡åŠ å¯†
- [ ] **SQLæ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢/ORM
- [ ] **XSSé˜²æŠ¤**ï¼šå†…å®¹è½¬ä¹‰ã€CSPç­–ç•¥
- [ ] **CSRFé˜²æŠ¤**ï¼šTokenéªŒè¯
- [ ] **APIé™æµ**ï¼šRedis + rate-limiter
- [ ] **æ–‡ä»¶ä¸Šä¼ å®‰å…¨**ï¼šç±»å‹æ£€æŸ¥ã€å¤§å°é™åˆ¶ã€ç—…æ¯’æ‰«æ
- [ ] **å¯†ç å®‰å…¨**ï¼šbcryptå“ˆå¸Œã€saltå¤„ç†

### æ•°æ®åˆè§„
- [ ] **GDPRåˆè§„**ï¼ˆæ¬§ç›Ÿï¼‰ï¼š
  - ç”¨æˆ·æ•°æ®å¯¼å‡ºåŠŸèƒ½
  - è´¦æˆ·åˆ é™¤ä¸æ•°æ®æ¸…ç†
  - CookieåŒæ„æ¨ªå¹…
  - éšç§æ”¿ç­–é¡µé¢
  
- [ ] **CCPAåˆè§„**ï¼ˆåŠ å·ï¼‰ï¼š
  - æ•°æ®æ”¶é›†é€æ˜åŒ–
  - é€‰æ‹©é€€å‡ºé€‰é¡¹

- [ ] **ä¸­å›½ç½‘ç»œå®‰å…¨æ³•**ï¼š
  - ICPå¤‡æ¡ˆ
  - æ•°æ®æœ¬åœ°åŒ–å­˜å‚¨

---

## ğŸš€ éƒ¨ç½²æ–¹æ¡ˆ

### ç¯å¢ƒåˆ’åˆ†
- **å¼€å‘ç¯å¢ƒ**ï¼šæœ¬åœ°Docker Compose
- **æµ‹è¯•ç¯å¢ƒ**ï¼šAWS/é˜¿é‡Œäº‘ EC2 + RDS
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šKubernetesé›†ç¾¤ + è´Ÿè½½å‡è¡¡

### ç”Ÿäº§æ¶æ„
```mermaid
graph TB
    subgraph "å…¨çƒCDN - Cloudflare"
        A[ç”¨æˆ·]
    end
    
    subgraph "è´Ÿè½½å‡è¡¡å±‚"
        B[ALB/NLB]
    end
    
    subgraph "åº”ç”¨é›†ç¾¤ - Kubernetes"
        C1[Next.js Pod 1]
        C2[Next.js Pod 2]
        D1[API Pod 1]
        D2[API Pod 2]
    end
    
    subgraph "æ•°æ®å±‚"
        E[(PostgreSQLä¸»åº“)]
        F[(PostgreSQLä»åº“)]
        G[Redisé›†ç¾¤]
        H[S3/OSS]
    end
    
    A --> B
    B --> C1
    B --> C2
    B --> D1
    B --> D2
    
    C1 --> D1
    C2 --> D2
    D1 --> E
    D2 --> E
    D1 --> G
    D2 --> G
    D1 --> H
    E --> F
```

### CI/CDæµç¨‹
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: npm test
      
  build:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Build Docker image
        run: docker build -t greeting-card:${{ github.sha }} .
      - name: Push to registry
        run: docker push greeting-card:${{ github.sha }}
  
  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to Kubernetes
        run: kubectl set image deployment/greeting-card app=greeting-card:${{ github.sha }}
```

---

## ğŸŒ GEOæŠ€æœ¯å®ç°æ–¹æ¡ˆ

### GEOæ¶æ„è®¾è®¡

GEOä¼˜åŒ–æ˜¯æ”¯æ’‘å…¨çƒåŒ–æ‰©å±•çš„å…³é”®æŠ€æœ¯åº•åº§ï¼Œæ¶‰åŠå¤šåŒºåŸŸéƒ¨ç½²ã€æ™ºèƒ½æµé‡è°ƒåº¦ã€æœ¬åœ°åŒ–æ•°æ®æœåŠ¡ç­‰æ ¸å¿ƒèƒ½åŠ›ã€‚

#### å…¨çƒå¤šåŒºåŸŸéƒ¨ç½²æ¶æ„

```mermaid
graph TB
    subgraph "å…¨çƒDNS - Cloudflare"
        DNS[æ™ºèƒ½DNSè§£æ<br/>GeoDNS]
    end
    
    subgraph "åŒ—ç¾åŒºåŸŸ - us-east-1"
        LB1[è´Ÿè½½å‡è¡¡å™¨]
        APP1[åº”ç”¨é›†ç¾¤]
        DB1[(PostgreSQL)]
        CACHE1[Redis]
        CDN1[åŒºåŸŸCDNèŠ‚ç‚¹]
    end
    
    subgraph "æ¬§æ´²åŒºåŸŸ - eu-west-1"
        LB2[è´Ÿè½½å‡è¡¡å™¨]
        APP2[åº”ç”¨é›†ç¾¤]
        DB2[(PostgreSQL)]
        CACHE2[Redis]
        CDN2[åŒºåŸŸCDNèŠ‚ç‚¹]
    end
    
    subgraph "äºšæ´²åŒºåŸŸ - ap-east-1"
        LB3[è´Ÿè½½å‡è¡¡å™¨]
        APP3[åº”ç”¨é›†ç¾¤]
        DB3[(PostgreSQL)]
        CACHE3[Redis]
        CDN3[åŒºåŸŸCDNèŠ‚ç‚¹]
    end
    
    subgraph "å…¨å±€æœåŠ¡"
        S3[å¯¹è±¡å­˜å‚¨ S3/OSS<br/>è·¨åŒºåŸŸå¤åˆ¶]
        AIAPI[AI API<br/>OpenAI/Kimi]
    end
    
    DNS -->|ç”¨æˆ·åœ¨ç¾å›½| LB1
    DNS -->|ç”¨æˆ·åœ¨æ¬§æ´²| LB2
    DNS -->|ç”¨æˆ·åœ¨äºšæ´²| LB3
    
    LB1 --> APP1 --> DB1
    LB2 --> APP2 --> DB2
    LB3 --> APP3 --> DB3
    
    APP1 --> CACHE1
    APP2 --> CACHE2
    APP3 --> CACHE3
    
    APP1 --> S3
    APP2 --> S3
    APP3 --> S3
    
    APP1 --> AIAPI
    APP2 --> AIAPI
    APP3 --> AIAPI
    
    DB1 -.ä¸»ä»å¤åˆ¶.-> DB2
    DB2 -.ä¸»ä»å¤åˆ¶.-> DB3
```

---

### ğŸ—ºï¸ åœ°ç†ä½ç½®æ£€æµ‹ä¸è·¯ç”±

#### 1. IPåœ°ç†ä½ç½®æ£€æµ‹
```javascript
// ä½¿ç”¨Cloudflare Headersè·å–åœ°ç†ä½ç½®
export async function detectUserLocation(request) {
  const country = request.headers.get('CF-IPCountry') || 'US';
  const city = request.headers.get('CF-IPCity');
  const timezone = request.headers.get('CF-Timezone');
  const latitude = request.headers.get('CF-IPLatitude');
  const longitude = request.headers.get('CF-IPLongitude');
  
  return {
    country,
    city,
    timezone,
    coordinates: { latitude, longitude }
  };
}

// å¤‡é€‰æ–¹æ¡ˆï¼šMaxMind GeoIP2
import maxmind from 'maxmind';

export async function getGeoFromIP(ip) {
  const lookup = await maxmind.open('/path/to/GeoLite2-City.mmdb');
  const geoData = lookup.get(ip);
  
  return {
    country: geoData.country.iso_code,
    city: geoData.city.names.en,
    timezone: geoData.location.time_zone,
    coordinates: {
      latitude: geoData.location.latitude,
      longitude: geoData.location.longitude
    }
  };
}
```

#### 2. æ™ºèƒ½è¯­è¨€æ£€æµ‹
```javascript
// æŒ‰ä¼˜å…ˆçº§æ£€æµ‹ç”¨æˆ·è¯­è¨€
export function detectUserLanguage(request, userProfile) {
  // 1. ç”¨æˆ·è®¾ç½®çš„è¯­è¨€ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  if (userProfile?.language) {
    return userProfile.language;
  }
  
  // 2. Cookieä¸­ä¿å­˜çš„è¯­è¨€åå¥½
  const cookieLang = request.cookies.get('preferred_language');
  if (cookieLang) {
    return cookieLang;
  }
  
  // 3. æ ¹æ®åœ°ç†ä½ç½®æ¨æ–­
  const country = request.headers.get('CF-IPCountry');
  const countryToLanguage = {
    'US': 'en',
    'GB': 'en',
    'CA': 'en',
    'FR': 'fr',
    'DE': 'de',
    'ES': 'es',
    'CN': 'zh',
    'JP': 'ja',
    'KR': 'ko'
  };
  
  if (countryToLanguage[country]) {
    return countryToLanguage[country];
  }
  
  // 4. Accept-Language header
  const acceptLang = request.headers.get('Accept-Language');
  if (acceptLang) {
    const primaryLang = acceptLang.split(',')[0].split('-')[0];
    return primaryLang;
  }
  
  // 5. é»˜è®¤è‹±è¯­
  return 'en';
}
```

#### 3. Next.jsä¸­é—´ä»¶å®ç°
```javascript
// middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  const country = request.geo?.country || 'US';
  const pathname = request.nextUrl.pathname;
  
  // è·³è¿‡APIè·¯ç”±å’Œé™æ€èµ„æº
  if (pathname.startsWith('/api') || pathname.startsWith('/_next')) {
    return NextResponse.next();
  }
  
  // è¯­è¨€è·¯å¾„æ˜ å°„
  const localePathMapping = {
    'US': '/en-us',
    'GB': '/en-gb',
    'FR': '/fr-fr',
    'DE': '/de-de',
    'ES': '/es-es',
    'CN': '/zh-cn',
  };
  
  const targetLocale = localePathMapping[country] || '/en-us';
  
  // å¦‚æœç”¨æˆ·è®¿é—®æ ¹è·¯å¾„ï¼Œé‡å®šå‘åˆ°å¯¹åº”è¯­è¨€ç‰ˆæœ¬
  if (pathname === '/') {
    return NextResponse.redirect(new URL(targetLocale, request.url));
  }
  
  // æ·»åŠ åœ°ç†ä½ç½®headerä¾›åº”ç”¨ä½¿ç”¨
  const response = NextResponse.next();
  response.headers.set('X-User-Country', country);
  response.headers.set('X-User-Timezone', request.geo?.timezone || 'UTC');
  
  return response;
}

export const config = {
  matcher: ['/((?!api|_next/static|_next/image|favicon.ico).*)'],
};
```

---

### ğŸš€ CDNä¸å†…å®¹åˆ†å‘ä¼˜åŒ–

#### 1. Cloudflare CDNé…ç½®
```javascript
// cloudflare-config.js
module.exports = {
  // ç¼“å­˜ç­–ç•¥
  cacheRules: [
    {
      // é™æ€èµ„æºé•¿æœŸç¼“å­˜
      pattern: '/static/*',
      cacheTTL: 31536000, // 1å¹´
      browserTTL: 31536000
    },
    {
      // æ¨¡æ¿é¢„è§ˆå›¾
      pattern: '/templates/preview/*',
      cacheTTL: 86400, // 1å¤©
      browserTTL: 3600, // 1å°æ—¶
    },
    {
      // HTMLé¡µé¢çŸ­æœŸç¼“å­˜
      pattern: '/*.html',
      cacheTTL: 3600,
      browserTTL: 600
    }
  ],
  
  // åœ°ç†ä½ç½®è·¯ç”±
  geoRouting: {
    'US': 'us-east-1.greetingcard.com',
    'EU': 'eu-west-1.greetingcard.com',
    'AS': 'ap-east-1.greetingcard.com',
  },
  
  // æ™ºèƒ½å‹ç¼©
  compression: {
    brotli: true,
    gzip: true,
    minSize: 1024 // å¤§äº1KBæ‰å‹ç¼©
  }
};
```

#### 2. S3è·¨åŒºåŸŸå¤åˆ¶
```yaml
# AWS S3 Cross-Region Replication
# s3-replication-config.yaml
ReplicationConfiguration:
  Role: arn:aws:iam::ACCOUNT-ID:role/s3-replication-role
  Rules:
    - Id: ReplicateToEU
      Status: Enabled
      Priority: 1
      Filter:
        Prefix: templates/
      Destination:
        Bucket: arn:aws:s3:::greetingcard-eu-west-1
        ReplicationTime:
          Status: Enabled
          Time:
            Minutes: 15
    - Id: ReplicateToAsia
      Status: Enabled
      Priority: 2
      Filter:
        Prefix: templates/
      Destination:
        Bucket: arn:aws:s3:::greetingcard-ap-east-1
        ReplicationTime:
          Status: Enabled
          Time:
            Minutes: 15
```

#### 3. å›¾ç‰‡CDNä¼˜åŒ–
```javascript
// ä½¿ç”¨Cloudflare Image Resizing
export function getOptimizedImageURL(originalUrl, options = {}) {
  const {
    width = 800,
    quality = 85,
    format = 'auto', // è‡ªåŠ¨é€‰æ‹©webpæˆ–åŸæ ¼å¼
    country = 'US'
  } = options;
  
  // Cloudflare Image Resizing
  const cdnUrl = `https://greetingcard.com/cdn-cgi/image/width=${width},quality=${quality},format=${format}/${originalUrl}`;
  
  return cdnUrl;
}

// ä½¿ç”¨ç¤ºä¾‹
const templatePreview = getOptimizedImageURL(
  'templates/birthday-001.jpg',
  { width: 600, quality: 80, country: userCountry }
);
```

---

### ğŸ’¾ æ•°æ®åº“åœ°ç†åˆ†å¸ƒç­–ç•¥

#### 1. è¯»å†™åˆ†ç¦» + åœ°ç†å°±è¿‘è®¿é—®
```javascript
// database-routing.js
import { Pool } from 'pg';

const dbPools = {
  'us-east-1': {
    master: new Pool({ host: 'us-db-master.internal', ... }),
    replica: new Pool({ host: 'us-db-replica.internal', ... })
  },
  'eu-west-1': {
    master: new Pool({ host: 'eu-db-master.internal', ... }),
    replica: new Pool({ host: 'eu-db-replica.internal', ... })
  },
  'ap-east-1': {
    master: new Pool({ host: 'ap-db-master.internal', ... }),
    replica: new Pool({ host: 'ap-db-replica.internal', ... })
  }
};

export function getDBConnection(region, operation = 'read') {
  const pool = dbPools[region];
  
  // å†™æ“ä½œç”¨ä¸»åº“ï¼Œè¯»æ“ä½œç”¨ä»åº“
  return operation === 'write' ? pool.master : pool.replica;
}

// ä½¿ç”¨ç¤ºä¾‹
export async function getUserCards(userId, userRegion) {
  const db = getDBConnection(userRegion, 'read');
  const result = await db.query(
    'SELECT * FROM cards WHERE user_id = $1',
    [userId]
  );
  return result.rows;
}
```

#### 2. æ•°æ®åˆ†ç‰‡ç­–ç•¥ï¼ˆå¯é€‰ - å¤§è§„æ¨¡æ—¶ï¼‰
```sql
-- æŒ‰åœ°ç†ä½ç½®åˆ†ç‰‡ç”¨æˆ·æ•°æ®
CREATE TABLE users_us PARTITION OF users
  FOR VALUES IN ('US', 'CA', 'MX');

CREATE TABLE users_eu PARTITION OF users  
  FOR VALUES IN ('GB', 'FR', 'DE', 'ES', 'IT');

CREATE TABLE users_asia PARTITION OF users
  FOR VALUES IN ('CN', 'JP', 'KR', 'SG');
```

---

### ğŸ¯ åŸºäºåœ°ç†ä½ç½®çš„åŠŸèƒ½å®ç°

#### 1. æ¨¡æ¿æ¨èç®—æ³•
```javascript
// template-recommendation.js
export async function getRecommendedTemplates(userCountry, occasion) {
  // è·å–å½“åœ°å³å°†åˆ°æ¥çš„èŠ‚æ—¥
  const upcomingHolidays = getUpcomingHolidays(userCountry);
  
  // æŸ¥è¯¢æœ¬åœ°åŒ–æ¨¡æ¿
  const templates = await db.query(`
    SELECT * FROM templates
    WHERE (
      -- å®Œå…¨åŒ¹é…ç”¨æˆ·å›½å®¶çš„æ¨¡æ¿
      country = $1
      OR
      -- åŒè¯­è¨€ä½†ä¸åŒå›½å®¶çš„æ¨¡æ¿
      language = (SELECT language FROM countries WHERE code = $1)
      OR
      -- é€šç”¨æ¨¡æ¿
      is_universal = true
    )
    AND (
      -- èŠ‚æ—¥ç›¸å…³
      category = ANY($2::text[])
      OR
      -- åœºæ™¯ç›¸å…³
      occasion = $3
    )
    ORDER BY
      -- ä¼˜å…ˆçº§ï¼šå®Œå…¨åŒ¹é… > è¯­è¨€åŒ¹é… > é€šç”¨
      CASE
        WHEN country = $1 THEN 1
        WHEN language = (SELECT language FROM countries WHERE code = $1) THEN 2
        ELSE 3
      END,
      popularity DESC
    LIMIT 20
  `, [userCountry, upcomingHolidays, occasion]);
  
  return templates.rows;
}

// èŠ‚æ—¥æ—¥å†ï¼ˆç®€åŒ–ç‰ˆï¼‰
function getUpcomingHolidays(country) {
  const now = new Date();
  const twoWeeksLater = new Date(now.getTime() + 14 * 24 * 60 * 60 * 1000);
  
  const holidayCalendar = {
    'US': [
      { name: 'Thanksgiving', date: '2026-11-26', categories: ['holiday', 'gratitude'] },
      { name: 'Christmas', date: '2026-12-25', categories: ['holiday', 'christmas'] },
    ],
    'CN': [
      { name: 'Spring Festival', date: '2026-02-17', categories: ['holiday', 'new-year'] },
      { name: 'Mid-Autumn', date: '2026-09-25', categories: ['holiday', 'moon-festival'] },
    ],
    // æ›´å¤šå›½å®¶...
  };
  
  return holidayCalendar[country]?.filter(h => {
    const holidayDate = new Date(h.date);
    return holidayDate >= now && holidayDate <= twoWeeksLater;
  }).flatMap(h => h.categories) || [];
}
```

#### 2. æ”¯ä»˜æ–¹å¼åŠ¨æ€å±•ç¤º
```javascript
// payment-methods.js
export function getAvailablePaymentMethods(country) {
  const paymentConfig = {
    'US': [
      { id: 'paypal', name: 'PayPal', icon: '/icons/paypal.svg', priority: 1 },
      { id: 'stripe', name: 'Credit Card', icon: '/icons/card.svg', priority: 2 },
      { id: 'applepay', name: 'Apple Pay', icon: '/icons/apple.svg', priority: 3 },
    ],
    'CN': [
      { id: 'alipay', name: 'æ”¯ä»˜å®', icon: '/icons/alipay.svg', priority: 1 },
      { id: 'wechatpay', name: 'å¾®ä¿¡æ”¯ä»˜', icon: '/icons/wechat.svg', priority: 2 },
      { id: 'unionpay', name: 'é“¶è”', icon: '/icons/unionpay.svg', priority: 3 },
    ],
    'DE': [
      { id: 'sepa', name: 'SEPA Direct Debit', icon: '/icons/sepa.svg', priority: 1 },
      { id: 'paypal', name: 'PayPal', icon: '/icons/paypal.svg', priority: 2 },
      { id: 'klarna', name: 'Klarna', icon: '/icons/klarna.svg', priority: 3 },
    ],
    // é»˜è®¤é€‰é¡¹
    'DEFAULT': [
      { id: 'paypal', name: 'PayPal', icon: '/icons/paypal.svg', priority: 1 },
      { id: 'stripe', name: 'Credit Card', icon: '/icons/card.svg', priority: 2 },
    ]
  };
  
  return paymentConfig[country] || paymentConfig['DEFAULT'];
}
```

#### 3. è´§å¸æœ¬åœ°åŒ–
```javascript
// currency-localization.js
const currencyByCountry = {
  'US': { code: 'USD', symbol: '$', rate: 1.0 },
  'GB': { code: 'GBP', symbol: 'Â£', rate: 0.82 },
  'EU': { code: 'EUR', symbol: 'â‚¬', rate: 0.92 },
  'CN': { code: 'CNY', symbol: 'Â¥', rate: 7.2 },
  'JP': { code: 'JPY', symbol: 'Â¥', rate: 148.5 },
};

export function formatPrice(priceUSD, country) {
  const currency = currencyByCountry[country] || currencyByCountry['US'];
  const localPrice = (priceUSD * currency.rate).toFixed(2);
  
  return `${currency.symbol}${localPrice}`;
}
```

---

### âš¡ æ€§èƒ½ä¼˜åŒ–

#### 1. Edge Computingï¼ˆè¾¹ç¼˜è®¡ç®—ï¼‰
```javascript
// ä½¿ç”¨Cloudflare Workersè¿›è¡Œè¾¹ç¼˜è®¡ç®—
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request));
});

async function handleRequest(request) {
  const url = new URL(request.url);
  const country = request.headers.get('CF-IPCountry') || 'US';
  
  // åœ¨è¾¹ç¼˜èŠ‚ç‚¹ç›´æ¥è¿”å›é™æ€æ¨¡æ¿åˆ—è¡¨ï¼ˆç¼“å­˜ï¼‰
  if (url.pathname === '/api/templates/popular') {
    const cacheKey = `popular-templates:${country}`;
    const cached = await EDGE_CACHE.get(cacheKey);
    
    if (cached) {
      return new Response(cached, {
        headers: { 'Content-Type': 'application/json' }
      });
    }
    
    // ç¼“å­˜æœªå‘½ä¸­ï¼Œä»æºç«™è·å–
    const response = await fetch(request);
    const data = await response.text();
    
    // ç¼“å­˜1å°æ—¶
    await EDGE_CACHE.put(cacheKey, data, { expirationTtl: 3600 });
    
    return new Response(data, {
      headers: { 'Content-Type': 'application/json' }
    });
  }
  
  return fetch(request);
}
```

---

### ğŸ“Š GEOæ€§èƒ½ç›‘æ§

#### 1. æŒ‰åœ°åŒºç›‘æ§æŒ‡æ ‡
```javascript
// geo-monitoring.js
export function trackGeoPerformance(req, res, next) {
  const startTime = Date.now();
  const country = req.headers['cf-ipcountry'] || 'UNKNOWN';
  const region = getRegionFromCountry(country);
  
  res.on('finish', () => {
    const duration = Date.now() - startTime;
    
    // è®°å½•åœ°ç†æ€§èƒ½æŒ‡æ ‡
    logger.info('geo_performance', {
      country,
      region,
      endpoint: req.path,
      duration,
      status: res.statusCode
    });
    
    // å‘é€åˆ°ç›‘æ§ç³»ç»Ÿï¼ˆPrometheusï¼‰
    metrics.histogram('api_request_duration_ms', duration, {
      country,
      region,
      endpoint: req.path
    });
  });
  
  next();
}
```

---

### ğŸš¢ GEOéƒ¨ç½²æ¸…å•

#### MVPé˜¶æ®µï¼ˆå•åŒºåŸŸï¼‰
- [x] Cloudflare CDNé…ç½®
- [x] åœ°ç†ä½ç½®æ£€æµ‹ä¸­é—´ä»¶
- [x] åŸºç¡€å¤šè¯­è¨€æ”¯æŒ

#### ç¬¬ä¸€é˜¶æ®µï¼ˆ3åŒºåŸŸï¼‰
- [ ] åŒ—ç¾ï¼ˆus-east-1ï¼‰ä¸»åŒºåŸŸéƒ¨ç½²
- [ ] æ¬§æ´²ï¼ˆeu-west-1ï¼‰åŒºåŸŸéƒ¨ç½²
- [ ] äºšæ´²ï¼ˆap-east-1ï¼‰åŒºåŸŸéƒ¨ç½²
- [ ] è·¨åŒºåŸŸæ•°æ®åŒæ­¥
- [ ] GeoDNSæ™ºèƒ½è·¯ç”±

#### ç¬¬äºŒé˜¶æ®µï¼ˆä¼˜åŒ–ï¼‰
- [ ] Edge Computingè¾¹ç¼˜è®¡ç®—
- [ ] æ•°æ®åº“è¯»å†™åˆ†ç¦»
- [ ] é™æ€èµ„æºåŒºåŸŸå¤åˆ¶
- [ ] æ€§èƒ½ç›‘æ§åˆ†åŒºdashboard

---

### ğŸ’° GEOæˆæœ¬ä¼°ç®—

| æœåŠ¡ | MVPï¼ˆå•åŒºåŸŸï¼‰ | 3åŒºåŸŸéƒ¨ç½² | æœˆæˆæœ¬ |
|------|-------------|----------|--------|
| Cloudflare CDN | Pro Plan | Business Plan | $200 |
| AWS/é˜¿é‡Œäº‘æœåŠ¡å™¨ | 1ä¸ªåŒºåŸŸ | 3ä¸ªåŒºåŸŸ | $800 |
| æ•°æ®åº“ | å•å®ä¾‹ | 3ä¸ªåŒºåŸŸä¸»ä» | $600 |
| å¯¹è±¡å­˜å‚¨+CDN | å•åŒºåŸŸ | è·¨åŒºåŸŸå¤åˆ¶ | $300 |
| **æ€»è®¡** | **$500/æœˆ** | **$1,900/æœˆ** | **-** |

**ROIåˆ†æ**ï¼š
- é€šè¿‡GEOä¼˜åŒ–ï¼Œé¢„è®¡å¯æå‡20-30%çš„è½¬åŒ–ç‡ï¼ˆåŠ è½½é€Ÿåº¦æå‡ï¼‰
- æœ¬åœ°åŒ–å†…å®¹æ¨èå¯æå‡15-25%çš„ç”¨æˆ·ç•™å­˜
- æŠ•å…¥äº§å‡ºæ¯”ï¼šçº¦6ä¸ªæœˆå›æœ¬

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### æµ‹è¯•é‡‘å­—å¡”
1. **å•å…ƒæµ‹è¯•**ï¼ˆ60%è¦†ç›–ç‡ç›®æ ‡ï¼‰
   - Jest + React Testing Library
   - ç»„ä»¶é€»è¾‘ã€å·¥å…·å‡½æ•°
   
2. **é›†æˆæµ‹è¯•**ï¼ˆ30%ï¼‰
   - APIç«¯åˆ°ç«¯æµ‹è¯•
   - Supertestæµ‹è¯•APIè·¯ç”±
   
3. **E2Eæµ‹è¯•**ï¼ˆ10%ï¼‰
   - Playwright / Cypress
   - å…³é”®ç”¨æˆ·æµç¨‹ï¼ˆæ³¨å†Œã€åˆ›å»ºè´ºå¡ã€æ”¯ä»˜ï¼‰

### æ€§èƒ½æµ‹è¯•
- **è´Ÿè½½æµ‹è¯•**ï¼šk6 / Artillery
- **ç›®æ ‡æŒ‡æ ‡**ï¼š
  - é¦–å±åŠ è½½ < 2ç§’
  - APIå“åº” < 200ms (p95)
  - æ”¯æŒ1000å¹¶å‘ç”¨æˆ·

---

## ğŸ“ˆ ç›‘æ§ä¸è¿ç»´

### ç›‘æ§æŒ‡æ ‡
- **ä¸šåŠ¡æŒ‡æ ‡**ï¼š
  - æ³¨å†Œç”¨æˆ·æ•°ã€æ´»è·ƒç”¨æˆ·æ•°
  - è´ºå¡åˆ›å»ºæ•°ã€åˆ†äº«æ•°
  - è®¢é˜…è½¬åŒ–ç‡ã€MRRï¼ˆæœˆåº¦ç»å¸¸æ€§æ”¶å…¥ï¼‰
  
- **æŠ€æœ¯æŒ‡æ ‡**ï¼š
  - æœåŠ¡å™¨CPU/å†…å­˜ä½¿ç”¨ç‡
  - APIé”™è¯¯ç‡ã€å“åº”æ—¶é—´
  - æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
  - CDNç¼“å­˜å‘½ä¸­ç‡

### æ—¥å¿—ç®¡ç†
- **ç»“æ„åŒ–æ—¥å¿—**ï¼šJSONæ ¼å¼
- **æ—¥å¿—çº§åˆ«**ï¼šERROR, WARN, INFO, DEBUG
- **æ—¥å¿—èšåˆ**ï¼šELK Stackæˆ–äº‘æ—¥å¿—æœåŠ¡

### å‘Šè­¦æœºåˆ¶
- **é”™è¯¯å‘Šè­¦**ï¼šé”™è¯¯ç‡ > 1%
- **æ€§èƒ½å‘Šè­¦**ï¼šAPIå“åº”æ—¶é—´ > 500ms (p95)
- **ä¸šåŠ¡å‘Šè­¦**ï¼šæ”¯ä»˜å¤±è´¥ç‡ > 5%
- **é€šçŸ¥æ¸ é“**ï¼šSlackã€é‚®ä»¶ã€PagerDuty

---

## ğŸ”„ è¿­ä»£è®¡åˆ’

### MVPç‰ˆæœ¬ï¼ˆv1.0ï¼‰- æ ¸å¿ƒåŠŸèƒ½
- âœ… ç”¨æˆ·æ³¨å†Œä¸ç™»å½•
- âœ… æ¨¡æ¿åº“æµè§ˆ
- âœ… åœ¨çº¿ç¼–è¾‘å™¨
- âœ… åŸºç¡€åˆ†äº«åŠŸèƒ½
- âœ… ä»˜è´¹è®¢é˜…

### v1.1 - AIå¢å¼º
- ğŸ”„ AIæ–‡æ¡ˆç”Ÿæˆ
- ğŸ”„ AIè®¾è®¡å»ºè®®
- ğŸ”„ æ™ºèƒ½æ’ç‰ˆ

### v1.2 - åä½œä¸ç¤¾äº¤
- ğŸ“… å®æ—¶åä½œç¼–è¾‘
- ğŸ“… è¯„è®ºåŠŸèƒ½
- ğŸ“… ç¤¾äº¤åª’ä½“æ·±åº¦é›†æˆ

### v1.3 - ç§»åŠ¨ç«¯ä¼˜åŒ–
- ğŸ“… å“åº”å¼ä¼˜åŒ–
- ğŸ“… è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
- ğŸ“… PWAæ”¯æŒ

---

## ğŸ’¡ æŠ€æœ¯é£é™©ä¸åº”å¯¹

| é£é™© | å½±å“ | æ¦‚ç‡ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| AI APIæˆæœ¬è¿‡é«˜ | é«˜ | ä¸­ | é™æµç­–ç•¥ã€ç¼“å­˜å¸¸è§æ–‡æ¡ˆã€è€ƒè™‘è‡ªæ‰˜ç®¡æ¨¡å‹ |
| Canvasç¼–è¾‘å™¨æ€§èƒ½é—®é¢˜ | ä¸­ | ä¸­ | è™šæ‹ŸåŒ–æ¸²æŸ“ã€æ‡’åŠ è½½ã€Web Worker |
| æ”¯ä»˜é›†æˆå¤æ‚åº¦ | ä¸­ | ä½ | ä¼˜å…ˆPaypalå’Œæ”¯ä»˜å®å›½é™…æ”¯ä»˜ï¼Œé€æ­¥æ‰©å±•å…¶ä»–æ¸ é“ |
| å®æ—¶åä½œåŒæ­¥å†²çª | é«˜ | ä¸­ | é‡‡ç”¨æˆç†Ÿçš„CRDTåº“ï¼ˆYjsï¼‰ |
| å¤šè¯­è¨€å†…å®¹ç®¡ç† | ä¸­ | é«˜ | ä½¿ç”¨CMSç³»ç»Ÿï¼ˆContentful/Strapiï¼‰ |
| å…¨çƒCDNå»¶è¿Ÿ | ä¸­ | ä½ | å¤šåŒºåŸŸéƒ¨ç½²ã€æ™ºèƒ½è·¯ç”± |

---

## ğŸ“š å¼€å‘è§„èŒƒ

### ä»£ç è§„èŒƒ
- **JavaScript/TypeScript**ï¼šESLint + Prettier
- **Gitæäº¤**ï¼šConventional Commitsæ ¼å¼
  ```
  feat: æ·»åŠ AIæ–‡æ¡ˆç”ŸæˆåŠŸèƒ½
  fix: ä¿®å¤ç¼–è¾‘å™¨æ–‡å­—å¯¹é½é—®é¢˜
  docs: æ›´æ–°APIæ–‡æ¡£
  ```
- **åˆ†æ”¯ç­–ç•¥**ï¼šGit Flow
  - `main`: ç”Ÿäº§ä»£ç 
  - `develop`: å¼€å‘åˆ†æ”¯
  - `feature/*`: åŠŸèƒ½åˆ†æ”¯
  - `hotfix/*`: ç´§æ€¥ä¿®å¤

### æ–‡æ¡£è¦æ±‚
- APIæ–‡æ¡£ï¼šOpenAPIè§„èŒƒ
- ç»„ä»¶æ–‡æ¡£ï¼šStorybook
- æ¶æ„å›¾ï¼šMermaid/draw.io
- READMEï¼šé¡¹ç›®è¯´æ˜ã€å¿«é€Ÿå¼€å§‹ã€éƒ¨ç½²æŒ‡å—

---

## ğŸ¯ æˆåŠŸæŒ‡æ ‡ï¼ˆKPIï¼‰

### æŠ€æœ¯æŒ‡æ ‡
- âœ… ä»£ç æµ‹è¯•è¦†ç›–ç‡ > 70%
- âœ… APIå¯ç”¨æ€§ > 99.5%
- âœ… é¡µé¢åŠ è½½æ—¶é—´ < 2ç§’
- âœ… SEOå¾—åˆ† > 90ï¼ˆLighthouseï¼‰

### ä¸šåŠ¡æŒ‡æ ‡
- ğŸ“ˆ Betaé˜¶æ®µæ³¨å†Œç”¨æˆ· > 1,000
- ğŸ“ˆ ä»˜è´¹è½¬åŒ–ç‡ > 5%
- ğŸ“ˆ ç”¨æˆ·ç•™å­˜ç‡ï¼ˆ7å¤©ï¼‰> 30%
- ğŸ“ˆ NPSï¼ˆå‡€æ¨èå€¼ï¼‰> 50

---

## ğŸ“ ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|----------|
| v1.0 | 2026-01-29 | åˆå§‹å¼€å‘è®¡åˆ’ï¼Œå®Œæ•´æŠ€æœ¯æ¶æ„å’Œå®æ–½æ–¹æ¡ˆ |

---

## ğŸ”— ç›¸å…³èµ„æº

- **äº§å“è¯´æ˜æ–‡æ¡£**ï¼š[äº§å“è¯´æ˜æ–‡æ¡£.md](file:///Users/hunkwu/Desktop/ai/greeting%20card/äº§å“è¯´æ˜æ–‡æ¡£.md)
- **Demoç½‘ç«™**ï¼šhttps://5inrhhxjtjbxa.ok.kimi.link/
- **é¡¹ç›®ç›®å½•**ï¼š`/Users/hunkwu/Desktop/ai/greeting card`
- **æŠ€æœ¯å‚è€ƒ**ï¼š
  - [Fabric.jså®˜æ–¹æ–‡æ¡£](http://fabricjs.com/)
  - [Next.jsæ–‡æ¡£](https://nextjs.org/docs)
  - [Stripeæ–‡æ¡£](https://stripe.com/docs)

---

**å›¢é˜Ÿåä½œå»ºè®®**ï¼š
- æ¯å‘¨æŠ€æœ¯è¯„å®¡ä¼šè®®
- æ¯æ—¥ç«™ä¼šï¼ˆ15åˆ†é’Ÿï¼‰
- Sprintå‘¨æœŸï¼š2å‘¨
- Code Reviewå¼ºåˆ¶è¦æ±‚ï¼ˆè‡³å°‘1äººå®¡æ ¸ï¼‰

**å¤‡æ³¨**ï¼šæœ¬å¼€å‘è®¡åˆ’åŸºäºdemoç½‘ç«™åˆ†æå’Œè¡Œä¸šæœ€ä½³å®è·µåˆ¶å®šï¼Œå…·ä½“å®æ–½æ—¶éœ€æ ¹æ®å›¢é˜Ÿè§„æ¨¡å’Œèµ„æºè°ƒæ•´ã€‚
